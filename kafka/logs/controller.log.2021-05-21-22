[2021-05-21 22:25:19,015] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2021-05-21 22:25:19,016] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2021-05-21 22:25:19,016] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(ReportTopic-2 -> List(0, 1, 2), Sensor-3 -> List(0, 1, 2)) (kafka.controller.KafkaController)
[2021-05-21 22:25:19,016] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2021-05-21 22:25:19,016] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2021-05-21 22:25:19,016] DEBUG [Controller id=2] Topics not in preferred replica for broker 5 HashMap(Sensor-2 -> List(5, 0, 1), ReportTopic-1 -> List(5, 0, 1)) (kafka.controller.KafkaController)
[2021-05-21 22:25:19,016] TRACE [Controller id=2] Leader imbalance ratio for broker 5 is 0.6666666666666666 (kafka.controller.KafkaController)
[2021-05-21 22:25:19,017] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2021-05-21 22:25:19,017] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap(Sensor-4 -> List(1, 5, 0), Sensor-0 -> List(1, 2, 5), ReportTopic-3 -> List(1, 2, 5)) (kafka.controller.KafkaController)
[2021-05-21 22:25:19,017] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2021-05-21 22:25:19,017] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2021-05-21 22:25:19,017] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap(Sensor-5 -> List(2, 0, 1), ReportTopic-4 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2021-05-21 22:25:19,017] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.5 (kafka.controller.KafkaController)
[2021-05-21 22:25:19,017] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2021-05-21 22:30:19,019] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2021-05-21 22:30:19,019] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2021-05-21 22:30:19,020] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(ReportTopic-2 -> List(0, 1, 2), Sensor-3 -> List(0, 1, 2)) (kafka.controller.KafkaController)
[2021-05-21 22:30:19,020] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2021-05-21 22:30:19,020] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2021-05-21 22:30:19,020] DEBUG [Controller id=2] Topics not in preferred replica for broker 5 HashMap(Sensor-2 -> List(5, 0, 1), ReportTopic-1 -> List(5, 0, 1)) (kafka.controller.KafkaController)
[2021-05-21 22:30:19,020] TRACE [Controller id=2] Leader imbalance ratio for broker 5 is 0.6666666666666666 (kafka.controller.KafkaController)
[2021-05-21 22:30:19,020] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2021-05-21 22:30:19,020] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap(Sensor-4 -> List(1, 5, 0), Sensor-0 -> List(1, 2, 5), ReportTopic-3 -> List(1, 2, 5)) (kafka.controller.KafkaController)
[2021-05-21 22:30:19,020] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2021-05-21 22:30:19,020] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2021-05-21 22:30:19,020] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap(Sensor-5 -> List(2, 0, 1), ReportTopic-4 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2021-05-21 22:30:19,020] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.5 (kafka.controller.KafkaController)
[2021-05-21 22:30:19,020] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2021-05-21 22:35:19,022] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2021-05-21 22:35:19,022] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2021-05-21 22:35:19,024] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(ReportTopic-2 -> List(0, 1, 2), Sensor-3 -> List(0, 1, 2)) (kafka.controller.KafkaController)
[2021-05-21 22:35:19,024] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2021-05-21 22:35:19,025] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2021-05-21 22:35:19,026] DEBUG [Controller id=2] Topics not in preferred replica for broker 5 HashMap(Sensor-2 -> List(5, 0, 1), ReportTopic-1 -> List(5, 0, 1)) (kafka.controller.KafkaController)
[2021-05-21 22:35:19,026] TRACE [Controller id=2] Leader imbalance ratio for broker 5 is 0.6666666666666666 (kafka.controller.KafkaController)
[2021-05-21 22:35:19,026] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2021-05-21 22:35:19,026] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap(Sensor-4 -> List(1, 5, 0), Sensor-0 -> List(1, 2, 5), ReportTopic-3 -> List(1, 2, 5)) (kafka.controller.KafkaController)
[2021-05-21 22:35:19,026] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2021-05-21 22:35:19,026] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2021-05-21 22:35:19,026] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap(Sensor-5 -> List(2, 0, 1), ReportTopic-4 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2021-05-21 22:35:19,027] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.5 (kafka.controller.KafkaController)
[2021-05-21 22:35:19,027] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2021-05-21 22:40:19,028] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2021-05-21 22:40:19,028] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2021-05-21 22:40:19,028] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(ReportTopic-2 -> List(0, 1, 2), Sensor-3 -> List(0, 1, 2)) (kafka.controller.KafkaController)
[2021-05-21 22:40:19,029] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2021-05-21 22:40:19,029] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2021-05-21 22:40:19,029] DEBUG [Controller id=2] Topics not in preferred replica for broker 5 HashMap(Sensor-2 -> List(5, 0, 1), ReportTopic-1 -> List(5, 0, 1)) (kafka.controller.KafkaController)
[2021-05-21 22:40:19,029] TRACE [Controller id=2] Leader imbalance ratio for broker 5 is 0.6666666666666666 (kafka.controller.KafkaController)
[2021-05-21 22:40:19,029] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2021-05-21 22:40:19,029] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap(Sensor-4 -> List(1, 5, 0), Sensor-0 -> List(1, 2, 5), ReportTopic-3 -> List(1, 2, 5)) (kafka.controller.KafkaController)
[2021-05-21 22:40:19,029] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2021-05-21 22:40:19,029] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2021-05-21 22:40:19,029] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap(Sensor-5 -> List(2, 0, 1), ReportTopic-4 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2021-05-21 22:40:19,029] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 0.5 (kafka.controller.KafkaController)
[2021-05-21 22:40:19,029] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2021-05-21 22:47:21,174] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@b065c63, name=log4j:logger=kafka.controller (kafka.controller)
[2021-05-21 22:47:39,179] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2021-05-21 22:47:39,415] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 1 and epoch zk version is now 1 (kafka.controller.KafkaController)
[2021-05-21 22:47:39,407] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2021-05-21 22:47:39,678] INFO [ControllerEventThread controllerId=3] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2021-05-21 22:47:39,721] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2021-05-21 22:47:39,773] INFO [Controller id=0] Creating FeatureZNode at path: /feature with contents: FeatureZNode(Enabled,Features{}) (kafka.controller.KafkaController)
[2021-05-21 22:47:39,957] DEBUG [Controller id=3] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2021-05-21 22:47:40,607] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2021-05-21 22:47:40,615] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2021-05-21 22:47:40,621] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2021-05-21 22:47:40,627] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2021-05-21 22:47:40,898] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2021-05-21 22:47:40,983] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 99, 1 -> 101, 2 -> 104, 3 -> 100) (kafka.controller.KafkaController)
[2021-05-21 22:47:40,997] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2021-05-21 22:47:40,997] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0, 1, 2, 3) (kafka.controller.KafkaController)
[2021-05-21 22:47:41,129] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2021-05-21 22:47:41,386] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2021-05-21 22:47:41,391] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2021-05-21 22:47:41,394] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2021-05-21 22:47:41,496] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2021-05-21 22:47:41,536] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2021-05-21 22:47:41,536] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2021-05-21 22:47:41,545] INFO [Controller id=0] Currently active brokers in the cluster: Set(0, 1, 2, 3) (kafka.controller.KafkaController)
[2021-05-21 22:47:41,546] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2021-05-21 22:47:41,546] INFO [Controller id=0] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2021-05-21 22:47:41,547] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2021-05-21 22:47:41,559] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2021-05-21 22:47:41,573] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2021-05-21 22:47:41,579] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2021-05-21 22:47:41,588] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2021-05-21 22:47:41,589] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2021-05-21 22:47:41,594] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2021-05-21 22:47:41,838] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2021-05-21 22:47:41,839] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2021-05-21 22:47:41,842] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2021-05-21 22:47:41,843] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2021-05-21 22:47:41,843] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2021-05-21 22:47:41,844] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2021-05-21 22:47:41,942] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2021-05-21 22:47:41,942] INFO [Controller id=0] Ready to serve as the new controller with epoch 1 (kafka.controller.KafkaController)
[2021-05-21 22:47:41,956] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9095 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2021-05-21 22:47:41,958] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9094 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2021-05-21 22:47:41,959] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9093 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2021-05-21 22:47:41,967] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9096 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2021-05-21 22:47:42,042] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2021-05-21 22:47:42,042] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2021-05-21 22:47:42,043] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2021-05-21 22:47:42,043] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2021-05-21 22:47:42,074] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2021-05-21 22:47:42,197] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2021-05-21 22:47:42,510] INFO [Controller id=0] Newly added brokers: 4, deleted brokers: , bounced brokers: , all live brokers: 0,1,2,3,4 (kafka.controller.KafkaController)
[2021-05-21 22:47:42,519] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 4 (kafka.controller.ControllerChannelManager)
[2021-05-21 22:47:42,873] INFO [Controller id=0] New broker startup callback for 4 (kafka.controller.KafkaController)
[2021-05-21 22:47:42,947] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2021-05-21 22:47:42,972] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9097 (id: 4 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2021-05-21 22:47:42,976] DEBUG [Controller id=0] Register BrokerModifications handler for List(4) (kafka.controller.KafkaController)
[2021-05-21 22:47:42,982] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 99, 1 -> 101, 2 -> 104, 3 -> 100, 4 -> 111) (kafka.controller.KafkaController)
[2021-05-21 22:47:43,077] INFO [Controller id=0] Newly added brokers: 5, deleted brokers: , bounced brokers: , all live brokers: 0,1,2,3,4,5 (kafka.controller.KafkaController)
[2021-05-21 22:47:43,077] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 5 (kafka.controller.ControllerChannelManager)
[2021-05-21 22:47:43,113] INFO [Controller id=0] New broker startup callback for 5 (kafka.controller.KafkaController)
[2021-05-21 22:47:43,128] DEBUG [Controller id=0] Register BrokerModifications handler for List(5) (kafka.controller.KafkaController)
[2021-05-21 22:47:43,150] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 99, 1 -> 101, 2 -> 104, 3 -> 100, 4 -> 111, 5 -> 113) (kafka.controller.KafkaController)
[2021-05-21 22:47:43,154] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2021-05-21 22:47:43,154] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9098 (id: 5 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2021-05-21 22:47:43,191] INFO [ControllerEventThread controllerId=4] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2021-05-21 22:47:43,316] DEBUG [Controller id=4] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2021-05-21 22:47:43,710] INFO [ControllerEventThread controllerId=5] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2021-05-21 22:47:43,742] DEBUG [Controller id=5] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2021-05-21 22:47:47,199] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2021-05-21 22:47:47,199] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2021-05-21 22:52:47,205] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2021-05-21 22:52:47,207] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2021-05-21 22:57:47,212] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2021-05-21 22:57:47,212] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
